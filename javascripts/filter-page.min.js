function frequency(e){var t=[],n=[],r;e.sort();for(var i=0;i<e.length;i++){if(e[i]!==r){t.push(e[i]);n.push(1)}else n[n.length-1]++;r=e[i]}return[t,n]}jQuery(document).ready(function(e){function n(){serialized=t.serializeArray();options=[];e.each(serialized,function(t,r){r=e(this);r=r[0];value=r.value;filter_type=e('*[name="'+r.name+'"]:first').parents(".filter-section").attr("data-filter-type");if(typeof r.name=="undefined"||r.name==null)r.name="";value!=""&&value!=null&&typeof value!="undefined"&&(value=value.replace(" ","-"));if(r.name.substr(-2)=="[]"){n=r.name.substr(0,r.name.length-2);if(n in options)options[n].values.push(value);else{options[n]=[];options[n].type="array",options[n].values=[];options[n].values.push(value)}options[n].filter_type=filter_type}else if(r.name.substr(-5)=="[min]"){n=r.name.substr(0,r.name.length-5);if(!(n in options)){options[n]=[];options[n].type="range"}options[n].filter_type=filter_type;options[n].min=value}else if(r.name.substr(-5)=="[max]"){n=r.name.substr(0,r.name.length-5);if(!(n in options)){options[n]=[];options[n].type="range"}options[n].filter_type=filter_type;options[n].max=value}else{n=r.name;if(!(n in options)){options[n]=[];options[n].type="value";options[n].value=value;options[n].filter_type=filter_type}}});property_ids=[];o=0;for(var n in options){var r=options[n];if(r.type==="value"){if(r.value=="")properties=e(".property");else{classname=".property.filter_"+n+"-"+r.value;properties=e(classname)}property_ids[o]=[];e.each(properties,function(){property_ids[o].push(e(this).attr("data-id"))})}else if(r.type==="array"){i=[];if(r.filter_type=="or")e.each(r.values,function(t,r){classname=".property.filter_"+n+"-"+r;properties=e(classname);e.each(properties,function(){i.push(e(this).attr("data-id"))})});else{classname="";e.each(r.values,function(e,t){classname=classname+".property.filter_"+n+"-"+t});properties=e(classname);e.each(properties,function(){i.push(e(this).attr("data-id"))})}var i=i.filter(function(e,t,n){return t==n.indexOf(e)});property_ids[o]=i}else if(r.type==="range"){i=[];min=parseFloat(r.min);max=parseFloat(r.max);e.each(e("#propertyFilter .property"),function(){value=parseFloat(e(this).attr("data-"+n));value>=min&&value<=max&&i.push(e(this).attr("data-id"))});property_ids[o]=i}o++}var s=0;e.each(property_ids,function(){this.length==0&&(s=1)});properties=[];freq=0;e.each(property_ids,function(e,t){t!=""&&t!=null&&typeof t!="undefined"&&freq++;properties=properties.concat(t)});properties=frequency(properties);properties_to_show=[];for(var o in properties[1])properties[1][o]==freq&&properties_to_show.push(".post-"+properties[0][o]);properties_to_show=properties_to_show.join(",");if(properties_to_show==""||properties_to_show==null||typeof properties_to_show=="undefined"||s==1){properties_to_show=".noneatall";e("#filterNoResults").fadeIn()}else e("#filterNoResults").fadeOut();e("#propertyFilter").isotope({filter:properties_to_show})}var t=e("#filterPageSearch");e("#propertyFilter").isotope({itemSelector:".property",layoutMode:"straightDown"});e.each(t.find(".range"),function(){var t=e(this).attr("data-min"),r=e(this).attr("data-max"),i=e(this).attr("id"),s=e(this).attr("data-name"),o=e('.range-values[data-id="'+i+'"]'),u=e(this).attr("data-value_min"),a=e(this).attr("data-value_max");e(this).noUiSlider({range:[t,r],start:[t,r],step:r-t<100?1:20,slide:function(){var t=e(this).val();o.find(".min .value").html(number_format(parseFloat(t[0])));o.find(".max .value").html(number_format(parseFloat(t[1])));n()},serialization:{to:[s+"[min]",s+"[max]"],resolution:1}});if(u!=""&&a!=""){e(this).val([u,a]);o.find(".min .value").html(number_format(parseFloat(u)));o.find(".max .value").html(number_format(parseFloat(a)))}});t.find("select").on("change",function(){n()});t.find('input[type="text"]').on("keyup",function(){n()});e(document).on("change",'input[type="checkbox"]',function(){n()})});