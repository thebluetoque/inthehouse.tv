(function(e){e.fn.extend({bookingCalendar:function(t){function p(e){var t=r.datepicker("getDate");return t!=null?e=="date"?t:jQuery.datepicker.formatDate("yy-mm-dd",t):null}function d(e){var t=r.datepicker("getDate","+1d");if(t!=null){t.setDate(t.getDate()+1);return e=="date"?t:jQuery.datepicker.formatDate("yy-mm-dd",t)}}function v(e){var t=s.datepicker("getDate");return t!=null?e=="date"?t:jQuery.datepicker.formatDate("yy-mm-dd",t):null}function m(n){var r=jQuery.datepicker.formatDate("yy-mm-dd",n),i=p(),s=v();if(r<a)return[!1,"past"];if(t.bookedDays.indexOf(r)!==-1)return[!1,"booked"];if(i!=null&&s!=null&&r<=s&&r>=i)return[!0,"selected"];if(i==null&&r==s||s==null&&r==i)return[!0,"selected"];if(u=="week"){var o=-6,f=new Array,l=new Date(n);l.setDate(l.getDate()-7);var c=new Array,h=0,d=0;while(o<7){l.setDate(l.getDate()+1);f.push(jQuery.datepicker.formatDate("yy-mm-dd",l));o++}e.each(f,function(e,n){t.bookedDays.indexOf(n)!==-1?c.push(!1):c.push(!0)});e.each(c,function(e,t){if(t===!0){h++;h>d&&(d=h)}else h=0});return d>=7?[!0,"bookable"]:[!1,"invalid"]}return[!0,"bookable"]}function g(e){var n=jQuery.datepicker.formatDate("yy-mm-dd",e),r=p(),i=v();if(n<a)return[!1,"past"];if(r!=null&&a<=n&&n<r)return[!1,"invalid"];if(t.bookedDays.indexOf(n)!==-1){h=!0;return[!1,"booked"]}return h==1?[!1,"invalid"]:r!=null&&n==r?[!0,"selected"]:r!=null&&i!=null&&n<=i&&n>=r?[!0,"selected"]:r==null&&n==i||i==null&&n==r?[!0,"selected"]:[!0,"bookable"]}var n={bookedDays:[]};t=e.extend(n,t);var r=e(this).find(".start"),i=e(this).find(".start-field"),s=e(this).find(".end"),o=e(this).find(".end-field"),u=e(this).attr("data-interval"),a=new Date,f=a.getDate(),l=a.getMonth()+1,c=a.getFullYear();f<10&&(f="0"+f);l<10&&(l="0"+l);a=c+"-"+l+"-"+f;var h=!1;r.datepicker({changeMonth:!0,altField:i,altFormat:"yy-mm-dd",dateFormat:"DD, MM d, yy",beforeShowDay:m,onSelect:function(){s.val("");o.val("");refreshPrice()}});s.datepicker({changeMonth:!0,altField:o,altFormat:"yy-mm-dd",minDate:0,dateFormat:"DD, MM d, yy",beforeShowDay:g,beforeShow:function(){h=!1},onSelect:function(){refreshPrice()}})}})})(jQuery);